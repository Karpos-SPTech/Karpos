<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="http://www.chartjs.org/dist/2.7.1/Chart.js"></script>
    <script src="http://www.chartjs.org/samples/latest/utils.js"></script>
    <link rel="shortcut icon" href="../sidebar/src/images/logo-contato.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../SiteDashboard/style-dashboard.css">
    <link rel="shortcut icon" href="../SiteDashboard/assets/logo-contato.png" type="image/x-icon">
    <style>
        canvas {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
    <title>Karpos</title>
</head>

<body>
    <nav id="sidebar">
        <div id="sidebar_content">
            <div id="user">
                <img src="../SiteDashboard/assets/logo-contato.png" id="user_avatar" alt="Avatar">

                <p id="user_infos">
                    <span class="item-description">
                        Karpos Dash
                    </span>
                    <span class="item-description">
                        Bem vindo
                    </span>
                </p>
            </div>

            <ul id="side_items">
                <li class="side-item active" id="btnAreaUsuario">
                    <a href="#">
                        <i class="fa-solid fa-user"></i>
                        <span class="item-description">
                            Área do usuário
                        </span>
                    </a>

                </li>

                <li class="side-item" id="btnAreaTemperatura">
                    <a href="#">
                        <i class="fa-solid fa-temperature-three-quarters"></i>
                        <span class="item-description">
                            Temperatura
                        </span>
                    </a>
                </li>

                <li class="side-item" id="btnAreaUmidade">
                    <a href="#">
                        <i class="fa-solid fa-droplet"></i>
                        <span class="item-description">
                            Umidade
                        </span>
                    </a>
                </li>

                <li class="side-item" id="btnAreaTabelas">
                    <a href="#">
                        <i class="fa-solid fa-table"></i>
                        <span class="item-description">
                            Tabelas
                        </span>
                    </a>
                </li>

                <li class="side-item" id="btnAreaExportar">
                    <a href="#">
                        <i class="fa-solid fa-file-export"></i>
                        <span class="item-description">
                            Exportar
                        </span>
                    </a>
                </li>
            </ul>

            <button id="open_btn">
                <i id="open_btn_icon" class="fa-solid fa-chevron-right"></i>
            </button>
        </div>

        <div id="logout">
            <button id="logout_btn" onclick="exit()">
                <i class="fa-solid fa-right-from-bracket"></i>
                <span class="item-description">
                    Sair
                </span>
            </button>
        </div>
    </nav>
    <main id="main-class" style="height: 100%;">
        <section id="section_umidade" style="display:none; width: 900px;">
            <h1 class="principal"> MONITORAMENTO DOS ALGODÕES</h1>
            <h1 class="titulograf">Análise de Umidade na Plantação</h1>
            <canvas id="dht11Umidade"></canvas>
            <h1 class="titulograf">Dados Atuais:</h1>
            <div id="alertasU">
                <div class="fazenda">
                    <img width="100px" height="100px" src="../SiteDashboard/assets/fazendaa.png" alt="">
                    Fazenda Karpos
                    <p id="setor">Geral</p>
                </div>
                <div id="tempo1"></div>
                <div id="umiData">Umidade Atual:</div>
                <div id="textboxUmi"></div>
            </div>
        </section>

        <section id="section_temperatura" style="display: none; width: 900px;">
            <h1 class="principal"> MONITORAMENTO DOS ALGODÕES</h1>
            <h1 class="titulograf">Análise de Temperatura na Plantação</h1>
            <canvas id="lm35Temperatura"></canvas>
            <h1 class="titulograf">Dados Atuais:</h1>
            <div id="alertas">
                <div class="fazenda">
                    <img width="100px" height="100px" src="../SiteDashboard/assets/fazendaa.png" alt="">
                    Fazenda Karpos
                    <p id="setor1">Geral</p>
                </div>
                <div id="tempo"></div>
                <div id="tempData">Temperatura Atual:</div>
                <div id="textboxTemp"></div>
            </div>
        </section>

        <section id="section_areaDoUsuario" style="display: block;">
            <h1 style="font-size: 25px;">Área do Usuário</h1>
            <img class="imgf" src="../SiteDashboard/assets/fazendaa.png" width="100px" alt="">
            <h3 class="mensagem">Fazenda Karpos</h3>
            <h3>Lotes:</h3>
            <div class="lotes">
                <div class="boxlote"> <img src="../SiteDashboard/assets/logo-contato.png" width="50px"
                        style="margin-bottom: 5%;" alt="">Lote 1
                    <div style="margin-top: 5%;"><i id="iconTemp1" onclick="scrollToSection('section_temperatura', 'Lote 1')"
                            class="fas fa-thermometer-half icon"></i>
                        <i id="iconUmi1" onclick="scrollToSection('section_umidade', 'Lote 1 ')" class="fas fa-tint icon"></i>
                    </div>
                </div>
                <div class="boxlote"><img src="../SiteDashboard/assets/logo-contato.png" width="50px"
                        style="margin-bottom: 5%;" alt="">
                    <p>Lote 2</p>
                    <div style="margin-top: 5%;"><i id="iconTemp2" onclick="scrollToSection('section_temperatura', 'Lote 2')"
                            class="fas fa-thermometer-half icon"></i>
                        <i id="iconUmi2" onclick="scrollToSection('section_umidade', 'Lote 2 ')" class="fas fa-tint icon"></i>
                    </div>

                </div>
                <div class="boxlote"><img src="../SiteDashboard/assets/logo-contato.png" width="50px"
                        style="margin-bottom: 5%;" alt="">Lote 3
                    <div style="margin-top: 5%;"><i id="iconTemp3" onclick="scrollToSection('section_temperatura','Lote 3')"
                            class="fas fa-thermometer-half icon"></i>
                        <i id="iconUmi3" onclick="scrollToSection('section_umidade','Lote 3 ')" class="fas fa-tint icon"></i>
                    </div>
                </div>
                <div class="boxlote"><img src="../SiteDashboard/assets/logo-contato.png" width="50px"
                        style="margin-bottom: 5%;" alt="">Lote 4
                    <div style="margin-top: 5%;"><i id="iconTemp4" onclick="scrollToSection('section_temperatura', 'Lote 4')"
                            class="fas fa-thermometer-half icon"></i>
                        <i id="iconUmi4" onclick="scrollToSection('section_umidade', 'Lote 4 ')" class="fas fa-tint icon"></i>
                    </div>
                </div>
            </div>
            <h3 class="nossosavisos" style="margin-top: 2%;">Nossos Avisos:</h3>
            <div class="nossos">
                <div class="cada">
                    <div class="boxbom">
                        <img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt="">
                        <b>FAVORÁVEL</b>
                    </div>
                    <p class="desc">Tudo sob controle, mas continue monitorando para garantir a estabilidade e o
                        crescimento saudável da plantação. </p>
                </div>
                <div class="cada">
                    <div class="boxcuidado">
                        <img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt="">
                        <b>CUIDADO</b>
                    </div>
                    <p class="desc">A temperatura e/ou umidade estão prestes a sair do controle. Monitore de perto e
                        tome medidas preventivas para garantir a saúde dos algodões.</p>
                </div>

                <div class="cada">
                    <div class="boxalerta">
                        <img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt="">
                        <b>ALERTA</b>
                    </div>
                    <p class="desc">A temperatura e/ou umidade estão fora do padrão. Recomendamos ação imediata para
                        evitar possíveis danos à plantação.</p>
                </div>
            </div>
        </section>
        <section id="section_tabelas" style="display: none;">
            <h1>Área das tabelas</h1>
        </section>

    </main>

</body>

</html>
<script src="../SiteDashboard/script.js"></script>
<script src="../SiteDashboard/trocarsecao.js"></script>
<script src="verificacao.js"></script>

<script>

    // function scrollToSection(section_temperatura, lote) {
    //     // Encontra a seção pelo ID fornecido
    //     var section = document.getElementById(section_temperatura);

    //     // Define a propriedade display para 'block'
    //     section.style.display = 'block';
    //     section_areaDoUsuario.style.display = 'none';

    //     // Rola até a seção
    //     section.scrollIntoView({ behavior: 'smooth' });
    //     document.getElementById('setor').innerText = lote;
    // }

    // function scrollToSection1(section_umidade, lote) {
    //     // Encontra a seção pelo ID fornecido
    //     var section1 = document.getElementById(section_umidade);

    //     // Define a propriedade display para 'block'
    //     section1.style.display = 'block';
    //     section_areaDoUsuario.style.display = 'none';

    //     // Rola até a seção
    //     section1.scrollIntoView({ behavior: 'smooth' });
    //     document.getElementById('setor').innerText = lote;
    // }

    function scrollToSection(sectionId, lote) {
    // Encontra a seção pelo ID fornecido
    var section = document.getElementById(sectionId);

    // Define a propriedade display para 'block'
    section.style.display = 'block';
    section_areaDoUsuario.style.display = 'none';

    // Atualiza o texto da seção
    document.getElementById('setor').innerHTML = lote;
    document.getElementById('setor1').innerHTML = lote;

    // Rola até a seção
    section.scrollIntoView({ behavior: 'smooth' });
}

    /* -- dht11Umidade -- */

    // Função para gerar números aleatórios entre um intervalo específico
    function generateRandomData() {
        var data = [];
        for (var i = 0; i < 5; i++) {
            data.push(Math.floor(Math.random() * 100)); // Gera números aleatórios entre 0 e 100
        }
        return data;
    }

    // Dados aleatórios para o gráfico
    var randomData = generateRandomData();

    // Criação do gráfico
    var contextoDht11Umidade = document.getElementById('dht11Umidade').getContext('2d');
    contextoDht11Umidade.canvas.width = 950;
    contextoDht11Umidade.canvas.height = 300;
    var dht11Umidade = new Chart(contextoDht11Umidade, {
        type: 'line',
        data: {
            labels: ['Data Atual', 'Data Atual', 'Data Atual', 'Data Atual', 'Data Atual'],
            datasets: [{
                data: randomData,
                label: 'Umidade (%)',
                type: 'line',
                borderColor: ['#45b3e7'],
                backgroundColor: 'rgba(137, 207, 240, 0.6)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });

    function updateChartData() {
        // Remove o primeiro elemento da matriz de labels
        dht11Umidade.data.labels.shift();
        // Adiciona uma nova label ao final da matriz de labels
        dht11Umidade.data.labels.push(getFormattedDateTime());
        // Remove o primeiro elemento da matriz de dados
        dht11Umidade.data.datasets[0].data.shift();
        // Adiciona um novo valor aleatório ao final da matriz de dados
        var newUmidad = Math.floor(Math.random() * 100);
        dht11Umidade.data.datasets[0].data.push(newUmidad);

        dht11Umidade.update();

        document.getElementById('umiData').innerHTML = `Umidade Atual:<br> <b>${newUmidad}%</b>`;

        if (newUmidad > 70) {
            // Atualiza o conteúdo e o estilo da div de texto para exibir o alerta
            document.getElementById('textboxUmi').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Alerta: Umidade muito acima de 60%!</b>';
            document.getElementById('textboxUmi').style.backgroundColor = 'red';
            document.getElementById('textboxUmi').style.color = 'white';
            document.getElementById('textboxUmi').style.border = '1px solid black';
            document.getElementById('iconUmi1').style.color = 'white';
            document.getElementById('iconUmi2').style.color = 'yellow';
            document.getElementById('iconUmi3').style.color = 'red';
            document.getElementById('iconUmi4').style.color = 'yellow';

        } else if (newUmidad >= 65 && newUmidad <= 69) {
            document.getElementById('textboxUmi').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Cuidado: Umidade pouco acima de 60%!</b>';
            document.getElementById('textboxUmi').style.backgroundColor = 'yellow';
            document.getElementById('textboxUmi').style.color = 'black';
            document.getElementById('textboxUmi').style.border = '1px solid black';
            document.getElementById('iconUmi1').style.color = 'yellow';
            document.getElementById('iconUmi2').style.color = 'white';
            document.getElementById('iconUmi3').style.color = 'yellow';
            document.getElementById('iconUmi4').style.color = 'red';
        }
        else if (newUmidad >= 50 && newUmidad <= 55) {
            document.getElementById('textboxUmi').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Cuidado: Umidade pouco abaixo de 60%!</b>';
            document.getElementById('textboxUmi').style.backgroundColor = 'yellow';
            document.getElementById('textboxUmi').style.color = 'black';
            document.getElementById('textboxUmi').style.border = '1px solid black';
            document.getElementById('iconUmi1').style.color = 'red';
            document.getElementById('iconUmi2').style.color = 'yellow';
            document.getElementById('iconUmi3').style.color = 'yellow';
            document.getElementById('iconUmi4').style.color = 'white';
        }
        else if (newUmidad < 49) {
            document.getElementById('textboxUmi').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Alerta: Umidade muito abaixo de 60%!</b>';
            document.getElementById('textboxUmi').style.backgroundColor = 'red';
            document.getElementById('textboxUmi').style.color = 'white';
            document.getElementById('textboxUmi').style.border = '1px solid black';
            document.getElementById('iconUmi1').style.color = 'yellow';
            document.getElementById('iconUmi2').style.color = 'red';
            document.getElementById('iconUmi3').style.color = 'white';
            document.getElementById('iconUmi4').style.color = 'red';
        } else {
            // Caso a temperatura não esteja acima de 35°C, limpa o conteúdo e o estilo da div de texto
            document.getElementById('textboxUmi').innerHTML = '<b>Tudo Sob-Controle Algodões Protegidos</b>';
            document.getElementById('textboxUmi').style.backgroundColor = 'white';
            document.getElementById('textboxUmi').style.color = 'black';
            document.getElementById('textboxUmi').style.border = '1px solid black';
        }


    }

    // Chamada da função para atualizar os dados a cada intervalo de tempo (por exemplo, a cada segundo)
    setInterval(updateChartData, 3000); // 5000ms = 5 segundos

    // lm35Temperatura

    function generateRandomData1() {
        var data1 = [];
        for (var i = 0; i < 5; i++) {
            data1.push(Math.floor(Math.random() * 50)); // Gera números aleatórios entre 0 e 50
        }
        return data1;
    }

    // Dados aleatórios para o gráfico
    var randomData1 = generateRandomData1();

    // Criação do gráfico
    var contextoLm35Temperatura = document.getElementById('lm35Temperatura').getContext('2d');
    contextoLm35Temperatura.canvas.width = 950;
    contextoLm35Temperatura.canvas.height = 300;
    var lm35Temperatura = new Chart(contextoLm35Temperatura, {
        type: 'line',
        data: {
            labels: ['Data Atual', 'Data Atual', 'Data Atual', 'Data Atual', 'Data Atual'],
            datasets: [{
                data: randomData1,
                label: 'Temperatura (°C)',
                type: 'line',
                borderColor: ['#ffd902'],
                backgroundColor: 'rgba(255, 225, 53, 0.6)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });

    function updateChartData1() {
        // Remove o primeiro elemento da matriz de labels
        lm35Temperatura.data.labels.shift();
        // Adiciona uma nova label ao final da matriz de labels
        lm35Temperatura.data.labels.push(getFormattedDateTime());
        // Remove o primeiro elemento da matriz de dados
        lm35Temperatura.data.datasets[0].data.shift();
        // Adiciona um novo valor aleatório ao final da matriz de dados
        var newTemperature = Math.floor(Math.random() * 50);
        lm35Temperatura.data.datasets[0].data.push(newTemperature);
        // Atualiza o gráfico
        lm35Temperatura.update();

        document.getElementById('tempData').innerHTML = `Temperatura Atual:<br> <b>${newTemperature}ºC</b>`;

        // Verifica se a temperatura ultrapassou 35°C
        if (newTemperature > 30) {
            // Atualiza o conteúdo e o estilo da div de texto para exibir o alerta
            document.getElementById('textboxTemp').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Alerta: Temperatura acima de 30°C!</b>';
            document.getElementById('textboxTemp').style.backgroundColor = 'red';
            document.getElementById('textboxTemp').style.color = 'white';
            document.getElementById('textboxTemp').style.border = '1px solid black';
            document.getElementById('iconTemp1').style.color = 'red';
            document.getElementById('iconTemp2').style.color = 'yellow';
            document.getElementById('iconTemp3').style.color = 'white';
            document.getElementById('iconTemp4').style.color = 'yellow';

        } else if (newTemperature >= 28 && newTemperature <= 29) {
            document.getElementById('textboxTemp').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Cuidado: Temperatura próxima de 30°C!</b>';
            document.getElementById('textboxTemp').style.backgroundColor = 'yellow';
            document.getElementById('textboxTemp').style.color = 'black';
            document.getElementById('textboxTemp').style.border = '1px solid black';
            document.getElementById('iconTemp1').style.color = 'yellow';
            document.getElementById('iconTemp2').style.color = 'red';
            document.getElementById('iconTemp3').style.color = 'yellow';
            document.getElementById('iconTemp4').style.color = 'white';
        }
        else if (newTemperature >= 21 && newTemperature <= 22) {
            document.getElementById('textboxTemp').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Cuidado: Temperatura próxima de 20°C!</b>';
            document.getElementById('textboxTemp').style.backgroundColor = 'yellow';
            document.getElementById('textboxTemp').style.color = 'black';
            document.getElementById('textboxTemp').style.border = '1px solid black';
            document.getElementById('iconTemp1').style.color = 'white';
            document.getElementById('iconTemp2').style.color = 'yellow';
            document.getElementById('iconTemp3').style.color = 'red';
            document.getElementById('iconTemp4').style.color = 'yellow';
        }
        else if (newTemperature < 20) {
            document.getElementById('textboxTemp').innerHTML = '<img width="50px" src="https://cdn-icons-png.flaticon.com/512/272/272340.png" alt=""> <b>Alerta: Temperatura abaixo de 20°C!</b>';
            document.getElementById('textboxTemp').style.backgroundColor = 'red';
            document.getElementById('textboxTemp').style.color = 'white';
            document.getElementById('textboxTemp').style.border = '1px solid black';
            document.getElementById('iconTemp1').style.color = 'yellow';
            document.getElementById('iconTemp2').style.color = 'white';
            document.getElementById('iconTemp3').style.color = 'yellow';
            document.getElementById('iconTemp4').style.color = 'red';
        } else {
            // Caso a temperatura não esteja acima de 35°C, limpa o conteúdo e o estilo da div de texto
            document.getElementById('textboxTemp').innerHTML = '<b>Tudo Sob-Controle Algodões Protegidos</b>';
            document.getElementById('textboxTemp').style.backgroundColor = 'white';
            document.getElementById('textboxTemp').style.color = 'black';
            document.getElementById('textboxTemp').style.border = '1px solid black';
        }
    }

    function getFormattedDateTime() {
        var now = new Date();
        var formattedDateTime = now.toLocaleString(); // Obtém a data e hora atual no formato local
        return formattedDateTime;
    }

    // Chamada inicial da função para garantir que os dados sejam atualizados assim que a página for carregada
    updateChartData1();

    // Chamada da função para atualizar os dados a cada intervalo de tempo (por exemplo, a cada cinco segundos)
    setInterval(updateChartData1, 3000); // 5000ms = 5 segundos



    function updateDateTime() {
        var now = new Date();
        var datetimeElement = document.getElementById('tempo');
        var datetimeElement1 = document.getElementById('tempo1');
        datetimeElement.innerHTML = 'Data e Hora Atuais: ' + now.toLocaleString(); // Exibe a data e hora no formato local
        datetimeElement1.innerHTML = 'Data e Hora Atuais: ' + now.toLocaleString(); // Exibe a data e hora no formato local
    }

    // Chama inicialmente a função para exibir a data e hora atual
    updateDateTime();

    // Chama a função a cada segundo para manter a data e hora atualizada
    setInterval(updateDateTime, 1000); // 1000ms = 1 segundo



</script>